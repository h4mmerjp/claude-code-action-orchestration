# .github/workflows/claude-monitoring.yml
name: ğŸ“Š Claude Usage Monitoring

on:
  schedule:
    - cron: '0 0 * * *'  # æ¯æ—¥åˆå‰0æ™‚
  workflow_dispatch:

jobs:
  monitor:
    name: ğŸ“Š Usage Report
    runs-on: ubuntu-latest
    
    steps:
      - name: ğŸ“¥ Checkout
        uses: actions/checkout@v4

      - name: ğŸ“Š Generate Report
        run: |
          REPORT_DATE=$(date '+%Y-%m-%d %H:%M:%S')

          cat > usage-report.md << EOF
          # ğŸ“Š Claude Usage Report

          **Report Date:** ${REPORT_DATE}

          ## Model Usage (Last 30 Days)
          - **Sonnet 4.5:** Strategic tasks only
            - Planning and architecture
            - Integration and review
          - **Haiku 4.5:** Implementation tasks
            - Parallel task execution
            - Fast code generation

          ## Cost Optimization
          âœ… Maintaining 50-60% cost savings through strategic model usage

          ## Workflow Statistics
          - âš¡ Average parallel tasks: 5
          - ğŸ¯ Strategic planning: Sonnet 4.5
          - ğŸš€ Implementation: Haiku 4.5

          ## Recommendations
          - Continue using Haiku 4.5 for routine implementations
          - Reserve Sonnet 4.5 for complex architectural decisions
          - Monitor token usage patterns monthly

          ---
          *Generated automatically by Claude Monitoring Workflow*
          EOF

      - name: ğŸ’¬ Create Issue
        uses: actions/github-script@v7
        with:
          script: |
            const fs = require('fs');
            const reportBody = fs.readFileSync('usage-report.md', 'utf8');

            await github.rest.issues.create({
              owner: context.repo.owner,
              repo: context.repo.repo,
              title: 'ğŸ“Š Monthly Claude Usage Report - ' + new Date().toISOString().split('T')[0],
              body: reportBody,
              labels: ['metrics', 'claude']
            });
